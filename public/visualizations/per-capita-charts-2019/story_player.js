var Flourish=function(e){"use strict";function t(e,t,n,r,i){for(var o in e.getVersionNumber=function(){return e.version_number},e.setVersionNumber=function(t){e.version_number=t},e.id=t,e.version_number=n||0,r)e[o]=r[o];if(i)for(var o in i)e[o]=i[o]}function n(e,n,r){t(this,"object"==typeof n?(r=n).id:n,void 0,r),this.visualisation=e}function r(e,r,i){if(t(this,e,r,i),this.data_tables){var o=this;this.data_tables=this.data_tables.map((function(e){return new n(o,e)}))}}r.prototype.settingsForCurrentTemplate=function(){return this.settings&&this.template_id in this.settings?this.settings[this.template_id]:{}};var i="http://www.w3.org/1999/xhtml",o={svg:"http://www.w3.org/2000/svg",xhtml:i,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function a(e){var t=e+="",n=t.indexOf(":");return n>=0&&"xmlns"!==(t=e.slice(0,n))&&(e=e.slice(n+1)),o.hasOwnProperty(t)?{space:o[t],local:e}:e}function s(e){return function(){var t=this.ownerDocument,n=this.namespaceURI;return n===i&&t.documentElement.namespaceURI===i?t.createElement(e):t.createElementNS(n,e)}}function l(e){return function(){return this.ownerDocument.createElementNS(e.space,e.local)}}function u(e){var t=a(e);return(t.local?l:s)(t)}function c(){}function d(e){return null==e?c:function(){return this.querySelector(e)}}function f(e){return"object"==typeof e&&"length"in e?e:Array.from(e)}function p(){return[]}function h(e){return function(t){return t.matches(e)}}var m=Array.prototype.find;function y(){return this.firstElementChild}var v=Array.prototype.filter;function g(){return this.children}function _(e){return new Array(e.length)}function w(e,t){this.ownerDocument=e.ownerDocument,this.namespaceURI=e.namespaceURI,this._next=null,this._parent=e,this.__data__=t}function b(e){return function(){return e}}function A(e,t,n,r,i,o){for(var a,s=0,l=t.length,u=o.length;s<u;++s)(a=t[s])?(a.__data__=o[s],r[s]=a):n[s]=new w(e,o[s]);for(;s<l;++s)(a=t[s])&&(i[s]=a)}function S(e,t,n,r,i,o,a){var s,l,u,c=new Map,d=t.length,f=o.length,p=new Array(d);for(s=0;s<d;++s)(l=t[s])&&(p[s]=u=a.call(l,l.__data__,s,t)+"",c.has(u)?i[s]=l:c.set(u,l));for(s=0;s<f;++s)u=a.call(e,o[s],s,o)+"",(l=c.get(u))?(r[s]=l,l.__data__=o[s],c.delete(u)):n[s]=new w(e,o[s]);for(s=0;s<d;++s)(l=t[s])&&c.get(p[s])===l&&(i[s]=l)}function x(e){return e.__data__}function E(e,t){return e<t?-1:e>t?1:e>=t?0:NaN}function T(e){return function(){this.removeAttribute(e)}}function L(e){return function(){this.removeAttributeNS(e.space,e.local)}}function N(e,t){return function(){this.setAttribute(e,t)}}function F(e,t){return function(){this.setAttributeNS(e.space,e.local,t)}}function k(e,t){return function(){var n=t.apply(this,arguments);null==n?this.removeAttribute(e):this.setAttribute(e,n)}}function D(e,t){return function(){var n=t.apply(this,arguments);null==n?this.removeAttributeNS(e.space,e.local):this.setAttributeNS(e.space,e.local,n)}}function C(e){return e.ownerDocument&&e.ownerDocument.defaultView||e.document&&e||e.defaultView}function O(e){return function(){this.style.removeProperty(e)}}function M(e,t,n){return function(){this.style.setProperty(e,t,n)}}function I(e,t,n){return function(){var r=t.apply(this,arguments);null==r?this.style.removeProperty(e):this.style.setProperty(e,r,n)}}function R(e,t){return e.style.getPropertyValue(t)||C(e).getComputedStyle(e,null).getPropertyValue(t)}function H(e){return function(){delete this[e]}}function q(e,t){return function(){this[e]=t}}function U(e,t){return function(){var n=t.apply(this,arguments);null==n?delete this[e]:this[e]=n}}function z(e){return e.trim().split(/^|\s+/)}function P(e){return e.classList||new B(e)}function B(e){this._node=e,this._names=z(e.getAttribute("class")||"")}function j(e,t){for(var n=P(e),r=-1,i=t.length;++r<i;)n.add(t[r])}function G(e,t){for(var n=P(e),r=-1,i=t.length;++r<i;)n.remove(t[r])}function W(e){return function(){j(this,e)}}function Y(e){return function(){G(this,e)}}function V(e,t){return function(){(t.apply(this,arguments)?j:G)(this,e)}}function $(){this.textContent=""}function X(e){return function(){this.textContent=e}}function J(e){return function(){var t=e.apply(this,arguments);this.textContent=null==t?"":t}}function K(){this.innerHTML=""}function Q(e){return function(){this.innerHTML=e}}function Z(e){return function(){var t=e.apply(this,arguments);this.innerHTML=null==t?"":t}}function ee(){this.nextSibling&&this.parentNode.appendChild(this)}function te(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function ne(){return null}function re(){var e=this.parentNode;e&&e.removeChild(this)}function ie(){var e=this.cloneNode(!1),t=this.parentNode;return t?t.insertBefore(e,this.nextSibling):e}function oe(){var e=this.cloneNode(!0),t=this.parentNode;return t?t.insertBefore(e,this.nextSibling):e}function ae(e){return e.trim().split(/^|\s+/).map((function(e){var t="",n=e.indexOf(".");return n>=0&&(t=e.slice(n+1),e=e.slice(0,n)),{type:e,name:t}}))}function se(e){return function(){var t=this.__on;if(t){for(var n,r=0,i=-1,o=t.length;r<o;++r)n=t[r],e.type&&n.type!==e.type||n.name!==e.name?t[++i]=n:this.removeEventListener(n.type,n.listener,n.options);++i?t.length=i:delete this.__on}}}function le(e,t,n){return function(){var r,i=this.__on,o=function(e){return function(t){e.call(this,t,this.__data__)}}(t);if(i)for(var a=0,s=i.length;a<s;++a)if((r=i[a]).type===e.type&&r.name===e.name)return this.removeEventListener(r.type,r.listener,r.options),this.addEventListener(r.type,r.listener=o,r.options=n),void(r.value=t);this.addEventListener(e.type,o,n),r={type:e.type,name:e.name,value:t,listener:o,options:n},i?i.push(r):this.__on=[r]}}function ue(e,t,n){var r=C(e),i=r.CustomEvent;"function"==typeof i?i=new i(t,n):(i=r.document.createEvent("Event"),n?(i.initEvent(t,n.bubbles,n.cancelable),i.detail=n.detail):i.initEvent(t,!1,!1)),e.dispatchEvent(i)}function ce(e,t){return function(){return ue(this,e,t)}}function de(e,t){return function(){return ue(this,e,t.apply(this,arguments))}}w.prototype={constructor:w,appendChild:function(e){return this._parent.insertBefore(e,this._next)},insertBefore:function(e,t){return this._parent.insertBefore(e,t)},querySelector:function(e){return this._parent.querySelector(e)},querySelectorAll:function(e){return this._parent.querySelectorAll(e)}},B.prototype={add:function(e){this._names.indexOf(e)<0&&(this._names.push(e),this._node.setAttribute("class",this._names.join(" ")))},remove:function(e){var t=this._names.indexOf(e);t>=0&&(this._names.splice(t,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(e){return this._names.indexOf(e)>=0}};var fe=[null];function pe(e,t){this._groups=e,this._parents=t}function he(e){return e.forEach((e=>{null!==e&&"object"==typeof e&&Object.keys(e).forEach((t=>e[t]+=""))})),e}function me(e){if(!e||"function"!=typeof e){var t=Array.prototype.slice.call(arguments,1);if("event"===e)for(var n=0;n<t.length;n++)"object"==typeof t[n]&&"event_callback"in t[n]&&t[n].event_callback()}}function ye(e,t){if(!window.location.hostname.match(/\.flourish\.studio$/))return window.gtag=me;(function(e){return"string"==typeof e?new pe([[document.querySelector(e)]],[document.documentElement]):new pe([[e]],fe)})("head").append("script").attr("async",!0).attr("src","https://www.googletagmanager.com/gtag/js?id=G-KW52XHYN9H"),window.dataLayer=window.dataLayer||[],window.gtag=function(){window.dataLayer.push(arguments)};var n={cookie_domain:"flourish.studio"};void 0===t?gtag("consent","default",{ad_storage:"denied",analytics_storage:"denied",functionality_storage:"denied",personalization_storage:"denied",security_storage:"denied"}):n.user_id=t.id,gtag("js",new Date),gtag("config","G-KW52XHYN9H",n),void 0!==t&&(gtag("set",{dimension1:t.id}),t.company_type?gtag("set",{dimension3:"other"==t.company_type?"corporate":t.company_type}):gtag("set",{dimension3:t.has_active_subscription?"personal":"free"}));var r=new Date;return gtag("set",{dimension2:r.toISOString()}),function(){arguments.length>=3&&"event"===arguments[0]&&(window._mfq=window._mfq||[],window._mfq.push(["setVariable",arguments[1],arguments[2]])),window.gtag.apply(window.gtag,he(Array.prototype.slice.call(arguments)))}}pe.prototype={constructor:pe,select:function(e){"function"!=typeof e&&(e=d(e));for(var t=this._groups,n=t.length,r=new Array(n),i=0;i<n;++i)for(var o,a,s=t[i],l=s.length,u=r[i]=new Array(l),c=0;c<l;++c)(o=s[c])&&(a=e.call(o,o.__data__,c,s))&&("__data__"in o&&(a.__data__=o.__data__),u[c]=a);return new pe(r,this._parents)},selectAll:function(e){e="function"==typeof e?function(e){return function(){var t=e.apply(this,arguments);return null==t?[]:f(t)}}(e):function(e){return null==e?p:function(){return this.querySelectorAll(e)}}(e);for(var t=this._groups,n=t.length,r=[],i=[],o=0;o<n;++o)for(var a,s=t[o],l=s.length,u=0;u<l;++u)(a=s[u])&&(r.push(e.call(a,a.__data__,u,s)),i.push(a));return new pe(r,i)},selectChild:function(e){return this.select(null==e?y:function(e){return function(){return m.call(this.children,e)}}("function"==typeof e?e:h(e)))},selectChildren:function(e){return this.selectAll(null==e?g:function(e){return function(){return v.call(this.children,e)}}("function"==typeof e?e:h(e)))},filter:function(e){"function"!=typeof e&&(e=function(e){return function(){return this.matches(e)}}(e));for(var t=this._groups,n=t.length,r=new Array(n),i=0;i<n;++i)for(var o,a=t[i],s=a.length,l=r[i]=[],u=0;u<s;++u)(o=a[u])&&e.call(o,o.__data__,u,a)&&l.push(o);return new pe(r,this._parents)},data:function(e,t){if(!arguments.length)return Array.from(this,x);var n=t?S:A,r=this._parents,i=this._groups;"function"!=typeof e&&(e=b(e));for(var o=i.length,a=new Array(o),s=new Array(o),l=new Array(o),u=0;u<o;++u){var c=r[u],d=i[u],p=d.length,h=f(e.call(c,c&&c.__data__,u,r)),m=h.length,y=s[u]=new Array(m),v=a[u]=new Array(m),g=l[u]=new Array(p);n(c,d,y,v,g,h,t);for(var _,w,E=0,T=0;E<m;++E)if(_=y[E]){for(E>=T&&(T=E+1);!(w=v[T])&&++T<m;);_._next=w||null}}return(a=new pe(a,r))._enter=s,a._exit=l,a},enter:function(){return new pe(this._enter||this._groups.map(_),this._parents)},exit:function(){return new pe(this._exit||this._groups.map(_),this._parents)},join:function(e,t,n){var r=this.enter(),i=this,o=this.exit();return r="function"==typeof e?e(r):r.append(e+""),null!=t&&(i=t(i)),null==n?o.remove():n(o),r&&i?r.merge(i).order():i},merge:function(e){if(!(e instanceof pe))throw new Error("invalid merge");for(var t=this._groups,n=e._groups,r=t.length,i=n.length,o=Math.min(r,i),a=new Array(r),s=0;s<o;++s)for(var l,u=t[s],c=n[s],d=u.length,f=a[s]=new Array(d),p=0;p<d;++p)(l=u[p]||c[p])&&(f[p]=l);for(;s<r;++s)a[s]=t[s];return new pe(a,this._parents)},selection:function(){return this},order:function(){for(var e=this._groups,t=-1,n=e.length;++t<n;)for(var r,i=e[t],o=i.length-1,a=i[o];--o>=0;)(r=i[o])&&(a&&4^r.compareDocumentPosition(a)&&a.parentNode.insertBefore(r,a),a=r);return this},sort:function(e){function t(t,n){return t&&n?e(t.__data__,n.__data__):!t-!n}e||(e=E);for(var n=this._groups,r=n.length,i=new Array(r),o=0;o<r;++o){for(var a,s=n[o],l=s.length,u=i[o]=new Array(l),c=0;c<l;++c)(a=s[c])&&(u[c]=a);u.sort(t)}return new pe(i,this._parents).order()},call:function(){var e=arguments[0];return arguments[0]=this,e.apply(null,arguments),this},nodes:function(){return Array.from(this)},node:function(){for(var e=this._groups,t=0,n=e.length;t<n;++t)for(var r=e[t],i=0,o=r.length;i<o;++i){var a=r[i];if(a)return a}return null},size:function(){let e=0;for(const t of this)++e;return e},empty:function(){return!this.node()},each:function(e){for(var t=this._groups,n=0,r=t.length;n<r;++n)for(var i,o=t[n],a=0,s=o.length;a<s;++a)(i=o[a])&&e.call(i,i.__data__,a,o);return this},attr:function(e,t){var n=a(e);if(arguments.length<2){var r=this.node();return n.local?r.getAttributeNS(n.space,n.local):r.getAttribute(n)}return this.each((null==t?n.local?L:T:"function"==typeof t?n.local?D:k:n.local?F:N)(n,t))},style:function(e,t,n){return arguments.length>1?this.each((null==t?O:"function"==typeof t?I:M)(e,t,null==n?"":n)):R(this.node(),e)},property:function(e,t){return arguments.length>1?this.each((null==t?H:"function"==typeof t?U:q)(e,t)):this.node()[e]},classed:function(e,t){var n=z(e+"");if(arguments.length<2){for(var r=P(this.node()),i=-1,o=n.length;++i<o;)if(!r.contains(n[i]))return!1;return!0}return this.each(("function"==typeof t?V:t?W:Y)(n,t))},text:function(e){return arguments.length?this.each(null==e?$:("function"==typeof e?J:X)(e)):this.node().textContent},html:function(e){return arguments.length?this.each(null==e?K:("function"==typeof e?Z:Q)(e)):this.node().innerHTML},raise:function(){return this.each(ee)},lower:function(){return this.each(te)},append:function(e){var t="function"==typeof e?e:u(e);return this.select((function(){return this.appendChild(t.apply(this,arguments))}))},insert:function(e,t){var n="function"==typeof e?e:u(e),r=null==t?ne:"function"==typeof t?t:d(t);return this.select((function(){return this.insertBefore(n.apply(this,arguments),r.apply(this,arguments)||null)}))},remove:function(){return this.each(re)},clone:function(e){return this.select(e?oe:ie)},datum:function(e){return arguments.length?this.property("__data__",e):this.node().__data__},on:function(e,t,n){var r,i,o=ae(e+""),a=o.length;if(!(arguments.length<2)){for(s=t?le:se,r=0;r<a;++r)this.each(s(o[r],t,n));return this}var s=this.node().__on;if(s)for(var l,u=0,c=s.length;u<c;++u)for(r=0,l=s[u];r<a;++r)if((i=o[r]).type===l.type&&i.name===l.name)return l.value},dispatch:function(e,t){return this.each(("function"==typeof t?de:ce)(e,t))},[Symbol.iterator]:function*(){for(var e=this._groups,t=0,n=e.length;t<n;++t)for(var r,i=e[t],o=0,a=i.length;o<a;++o)(r=i[o])&&(yield r)}};var ve,ge,_e,we,be=!1,Ae=!1,Se=null,xe=!1;function Ee(){this._current_time=0,this.paused=!0,this._listeners=[]}function Te(){var e=document.querySelector(".play-pause.small"),t=document.querySelector(".play-pause.large");if(t)if(e){e=e.getBoundingClientRect();var n=getComputedStyle(t),r=parseInt(n.left),i=parseInt(n.top),o=null;requestAnimationFrame((function n(a){null==o&&(o=a);var s=a-o,l=Math.min(1,Math.max(0,s/1e3)),u=51*(1-l),c=51*(1-l),d=51*(1-l),f=1-l+.3*l,p=-50*(1-l)+"%",h=-50*(1-l)+"%",m=2.5*(1-l)+1*l;t.style.left=r*(1-l)+(e.left||0)*l+"px",t.style.top=i*(1-l)+(e.top||0)*l+"px",t.style.transform="translate("+p+","+h+") scale("+m+")",t.style.background="rgba("+u+","+c+","+d+","+f+")",l<1?requestAnimationFrame(n):t.parentNode.removeChild(t)}))}else t.parentNode.removeChild(t)}function Le(){ge.paused?Ne():Fe()}function Ne(){ke(ge.currentTime)>=ve.story.slides.length&&(ge.currentTime=0),ge.play();for(var e=document.querySelectorAll("nav .play-pause"),t=0;t<e.length;t++)e[t].classList.add("playing");Ae||Te(),Ae=!0}function Fe(){ge.pause();for(var e=document.querySelectorAll("nav .play-pause"),t=0;t<e.length;t++)e[t].classList.remove("playing")}function ke(e){for(var t=we.length-1;t>=0;t--)if(e>=we[t])return t}function De(){var e=ke(this.currentTime);ve.current_slide.index!==e?e!==Se&&(e<ve.story.slides.length?(be=_e(e),Se=e):(Fe(),ve.story.loops_at_end&&Ne())):Se=null}function Ce(){ge&&ge.removeEventListener("timeupdate",De),(ve.story.is_timed||xe)&&"scrolly"!==ve.story.presentation_mode?(ge=ve.story.audio_url?document.getElementById("story-audio-file"):new Ee).addEventListener("timeupdate",De):ge=null}function Oe(){var e=0;we=[0];for(var t=0;t<ve.story.slides.length;t++){var n=ve.story.slides[t];e+=null==n.duration?ve.story.default_slide_duration:n.duration,we.push(e)}}function Me(e){ge&&(be?be=!1:ge.currentTime=we[e])}Ee.prototype={get currentTime(){return this._current_time},set currentTime(e){void 0!==this._played_from&&(this._played_from+=e-this._current_time),this._current_time=e}},Ee.prototype.addEventListener=function(e,t){if("timeupdate"!==e)throw new Error("Event type unsupported - must be timeupdate, not "+e);this._listeners.push(t)},Ee.prototype.removeEventListener=function(e,t){if("timeupdate"!==e)throw new Error("Event type unsupported - must be timeupdate, not "+e);this._listeners=[]},Ee.prototype.play=function(){var e=this;this.paused=!1,this._played_from=e._current_time,this._t0=null,requestAnimationFrame((function t(n){e.paused||((null==e._t0||n<e._t0)&&(e._t0=n),e._current_time=Math.max(0,e._played_from+(n-e._t0)/1e3),e._listeners.forEach((function(t){t.call(e)})),requestAnimationFrame(t))})),Ae||Te(),Ae=!0},Ee.prototype.pause=function(){this.paused=!0};var Ie=Object.hasOwnProperty,Re=Object.setPrototypeOf,He=Object.isFrozen,qe=Object.getPrototypeOf,Ue=Object.getOwnPropertyDescriptor,ze=Object.freeze,Pe=Object.seal,Be=Object.create,je="undefined"!=typeof Reflect&&Reflect,Ge=je.apply,We=je.construct;Ge||(Ge=function(e,t,n){return e.apply(t,n)}),ze||(ze=function(e){return e}),Pe||(Pe=function(e){return e}),We||(We=function(e,t){return new(Function.prototype.bind.apply(e,[null].concat(
/*! @license DOMPurify | (c) Cure53 and other contributors | Released under the Apache license 2.0 and Mozilla Public License 2.0 | github.com/cure53/DOMPurify/blob/2.2.2/LICENSE */
function(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}(t))))});var Ye,Ve=rt(Array.prototype.forEach),$e=rt(Array.prototype.pop),Xe=rt(Array.prototype.push),Je=rt(String.prototype.toLowerCase),Ke=rt(String.prototype.match),Qe=rt(String.prototype.replace),Ze=rt(String.prototype.indexOf),et=rt(String.prototype.trim),tt=rt(RegExp.prototype.test),nt=(Ye=TypeError,function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return We(Ye,t)});function rt(e){return function(t){for(var n=arguments.length,r=Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];return Ge(e,t,r)}}function it(e,t){Re&&Re(e,null);for(var n=t.length;n--;){var r=t[n];if("string"==typeof r){var i=Je(r);i!==r&&(He(t)||(t[n]=i),r=i)}e[r]=!0}return e}function ot(e){var t=Be(null),n=void 0;for(n in e)Ge(Ie,e,[n])&&(t[n]=e[n]);return t}function at(e,t){for(;null!==e;){var n=Ue(e,t);if(n){if(n.get)return rt(n.get);if("function"==typeof n.value)return rt(n.value)}e=qe(e)}return function(e){return console.warn("fallback value for",e),null}}var st=ze(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","section","select","shadow","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),lt=ze(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","filter","font","g","glyph","glyphref","hkern","image","line","lineargradient","marker","mask","metadata","mpath","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),ut=ze(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),ct=ze(["animate","color-profile","cursor","discard","fedropshadow","feimage","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),dt=ze(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover"]),ft=ze(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),pt=ze(["#text"]),ht=ze(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","face","for","headers","height","hidden","high","href","hreflang","id","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","noshade","novalidate","nowrap","open","optimum","pattern","placeholder","playsinline","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","xmlns","slot"]),mt=ze(["accent-height","accumulate","additive","alignment-baseline","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","targetx","targety","transform","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),yt=ze(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),vt=ze(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),gt=Pe(/\{\{[\s\S]*|[\s\S]*\}\}/gm),_t=Pe(/<%[\s\S]*|[\s\S]*%>/gm),wt=Pe(/^data-[\-\w.\u00B7-\uFFFF]/),bt=Pe(/^aria-[\-\w]+$/),At=Pe(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|cid|xmpp):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),St=Pe(/^(?:\w+script|data):/i),xt=Pe(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),Et="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};function Tt(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}var Lt=function(){return"undefined"==typeof window?null:window},Nt=function(e,t){if("object"!==(void 0===e?"undefined":Et(e))||"function"!=typeof e.createPolicy)return null;var n=null,r="data-tt-policy-suffix";t.currentScript&&t.currentScript.hasAttribute(r)&&(n=t.currentScript.getAttribute(r));var i="dompurify"+(n?"#"+n:"");try{return e.createPolicy(i,{createHTML:function(e){return e}})}catch(e){return console.warn("TrustedTypes policy "+i+" could not be created."),null}};var Ft,kt,Dt=function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Lt(),n=function(t){return e(t)};if(n.version="2.2.8",n.removed=[],!t||!t.document||9!==t.document.nodeType)return n.isSupported=!1,n;var r=t.document,i=t.document,o=t.DocumentFragment,a=t.HTMLTemplateElement,s=t.Node,l=t.Element,u=t.NodeFilter,c=t.NamedNodeMap,d=void 0===c?t.NamedNodeMap||t.MozNamedAttrMap:c,f=t.Text,p=t.Comment,h=t.DOMParser,m=t.trustedTypes,y=l.prototype,v=at(y,"cloneNode"),g=at(y,"nextSibling"),_=at(y,"childNodes"),w=at(y,"parentNode");if("function"==typeof a){var b=i.createElement("template");b.content&&b.content.ownerDocument&&(i=b.content.ownerDocument)}var A=Nt(m,r),S=A&&ee?A.createHTML(""):"",x=i,E=x.implementation,T=x.createNodeIterator,L=x.createDocumentFragment,N=r.importNode,F={};try{F=ot(i).documentMode?i.documentMode:{}}catch(e){}var k={};n.isSupported="function"==typeof w&&E&&void 0!==E.createHTMLDocument&&9!==F;var D=gt,C=_t,O=wt,M=bt,I=St,R=xt,H=At,q=null,U=it({},[].concat(Tt(st),Tt(lt),Tt(ut),Tt(dt),Tt(pt))),z=null,P=it({},[].concat(Tt(ht),Tt(mt),Tt(yt),Tt(vt))),B=null,j=null,G=!0,W=!0,Y=!1,V=!1,$=!1,X=!1,J=!1,K=!1,Q=!1,Z=!0,ee=!1,te=!0,ne=!0,re=!1,ie={},oe=it({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]),ae=null,se=it({},["audio","video","img","source","image","track"]),le=null,ue=it({},["alt","class","for","id","label","name","pattern","placeholder","summary","title","value","style","xmlns"]),ce="http://www.w3.org/1998/Math/MathML",de="http://www.w3.org/2000/svg",fe="http://www.w3.org/1999/xhtml",pe=fe,he=null,me=i.createElement("form"),ye=function(e){he&&he===e||(e&&"object"===(void 0===e?"undefined":Et(e))||(e={}),e=ot(e),q="ALLOWED_TAGS"in e?it({},e.ALLOWED_TAGS):U,z="ALLOWED_ATTR"in e?it({},e.ALLOWED_ATTR):P,le="ADD_URI_SAFE_ATTR"in e?it(ot(ue),e.ADD_URI_SAFE_ATTR):ue,ae="ADD_DATA_URI_TAGS"in e?it(ot(se),e.ADD_DATA_URI_TAGS):se,B="FORBID_TAGS"in e?it({},e.FORBID_TAGS):{},j="FORBID_ATTR"in e?it({},e.FORBID_ATTR):{},ie="USE_PROFILES"in e&&e.USE_PROFILES,G=!1!==e.ALLOW_ARIA_ATTR,W=!1!==e.ALLOW_DATA_ATTR,Y=e.ALLOW_UNKNOWN_PROTOCOLS||!1,V=e.SAFE_FOR_TEMPLATES||!1,$=e.WHOLE_DOCUMENT||!1,K=e.RETURN_DOM||!1,Q=e.RETURN_DOM_FRAGMENT||!1,Z=!1!==e.RETURN_DOM_IMPORT,ee=e.RETURN_TRUSTED_TYPE||!1,J=e.FORCE_BODY||!1,te=!1!==e.SANITIZE_DOM,ne=!1!==e.KEEP_CONTENT,re=e.IN_PLACE||!1,H=e.ALLOWED_URI_REGEXP||H,pe=e.NAMESPACE||pe,V&&(W=!1),Q&&(K=!0),ie&&(q=it({},[].concat(Tt(pt))),z=[],!0===ie.html&&(it(q,st),it(z,ht)),!0===ie.svg&&(it(q,lt),it(z,mt),it(z,vt)),!0===ie.svgFilters&&(it(q,ut),it(z,mt),it(z,vt)),!0===ie.mathMl&&(it(q,dt),it(z,yt),it(z,vt))),e.ADD_TAGS&&(q===U&&(q=ot(q)),it(q,e.ADD_TAGS)),e.ADD_ATTR&&(z===P&&(z=ot(z)),it(z,e.ADD_ATTR)),e.ADD_URI_SAFE_ATTR&&it(le,e.ADD_URI_SAFE_ATTR),ne&&(q["#text"]=!0),$&&it(q,["html","head","body"]),q.table&&(it(q,["tbody"]),delete B.tbody),ze&&ze(e),he=e)},ve=it({},["mi","mo","mn","ms","mtext"]),ge=it({},["foreignobject","desc","title","annotation-xml"]),_e=it({},lt);it(_e,ut),it(_e,ct);var we=it({},dt);it(we,ft);var be=function(e){var t=w(e);t&&t.tagName||(t={namespaceURI:fe,tagName:"template"});var n=Je(e.tagName),r=Je(t.tagName);if(e.namespaceURI===de)return t.namespaceURI===fe?"svg"===n:t.namespaceURI===ce?"svg"===n&&("annotation-xml"===r||ve[r]):Boolean(_e[n]);if(e.namespaceURI===ce)return t.namespaceURI===fe?"math"===n:t.namespaceURI===de?"math"===n&&ge[r]:Boolean(we[n]);if(e.namespaceURI===fe){if(t.namespaceURI===de&&!ge[r])return!1;if(t.namespaceURI===ce&&!ve[r])return!1;var i=it({},["title","style","font","a","script"]);return!we[n]&&(i[n]||!_e[n])}return!1},Ae=function(e){Xe(n.removed,{element:e});try{e.parentNode.removeChild(e)}catch(t){try{e.outerHTML=S}catch(t){e.remove()}}},Se=function(e,t){try{Xe(n.removed,{attribute:t.getAttributeNode(e),from:t})}catch(e){Xe(n.removed,{attribute:null,from:t})}if(t.removeAttribute(e),"is"===e&&!z[e])if(K||Q)try{Ae(t)}catch(e){}else try{t.setAttribute(e,"")}catch(e){}},xe=function(e){var t=void 0,n=void 0;if(J)e="<remove></remove>"+e;else{var r=Ke(e,/^[\r\n\t ]+/);n=r&&r[0]}var o=A?A.createHTML(e):e;if(pe===fe)try{t=(new h).parseFromString(o,"text/html")}catch(e){}t&&t.documentElement||((t=E.createDocument(pe,"template",null)).documentElement.innerHTML=o);var a=t.body||t.documentElement;return e&&n&&a.insertBefore(i.createTextNode(n),a.childNodes[0]||null),$?t.documentElement:a},Ee=function(e){return T.call(e.ownerDocument||e,e,u.SHOW_ELEMENT|u.SHOW_COMMENT|u.SHOW_TEXT,(function(){return u.FILTER_ACCEPT}),!1)},Te=function(e){return!(e instanceof f||e instanceof p)&&!("string"==typeof e.nodeName&&"string"==typeof e.textContent&&"function"==typeof e.removeChild&&e.attributes instanceof d&&"function"==typeof e.removeAttribute&&"function"==typeof e.setAttribute&&"string"==typeof e.namespaceURI&&"function"==typeof e.insertBefore)},Le=function(e){return"object"===(void 0===s?"undefined":Et(s))?e instanceof s:e&&"object"===(void 0===e?"undefined":Et(e))&&"number"==typeof e.nodeType&&"string"==typeof e.nodeName},Ne=function(e,t,r){k[e]&&Ve(k[e],(function(e){e.call(n,t,r,he)}))},Fe=function(e){var t=void 0;if(Ne("beforeSanitizeElements",e,null),Te(e))return Ae(e),!0;if(Ke(e.nodeName,/[\u0080-\uFFFF]/))return Ae(e),!0;var r=Je(e.nodeName);if(Ne("uponSanitizeElement",e,{tagName:r,allowedTags:q}),!Le(e.firstElementChild)&&(!Le(e.content)||!Le(e.content.firstElementChild))&&tt(/<[/\w]/g,e.innerHTML)&&tt(/<[/\w]/g,e.textContent))return Ae(e),!0;if(!q[r]||B[r]){if(ne&&!oe[r]){var i=w(e)||e.parentNode,o=_(e)||e.childNodes;if(o&&i)for(var a=o.length-1;a>=0;--a)i.insertBefore(v(o[a],!0),g(e))}return Ae(e),!0}return e instanceof l&&!be(e)?(Ae(e),!0):"noscript"!==r&&"noembed"!==r||!tt(/<\/no(script|embed)/i,e.innerHTML)?(V&&3===e.nodeType&&(t=e.textContent,t=Qe(t,D," "),t=Qe(t,C," "),e.textContent!==t&&(Xe(n.removed,{element:e.cloneNode()}),e.textContent=t)),Ne("afterSanitizeElements",e,null),!1):(Ae(e),!0)},ke=function(e,t,n){if(te&&("id"===t||"name"===t)&&(n in i||n in me))return!1;if(W&&tt(O,t));else if(G&&tt(M,t));else{if(!z[t]||j[t])return!1;if(le[t]);else if(tt(H,Qe(n,R,"")));else if("src"!==t&&"xlink:href"!==t&&"href"!==t||"script"===e||0!==Ze(n,"data:")||!ae[e]){if(Y&&!tt(I,Qe(n,R,"")));else if(n)return!1}else;}return!0},De=function(e){var t=void 0,r=void 0,i=void 0,o=void 0;Ne("beforeSanitizeAttributes",e,null);var a=e.attributes;if(a){var s={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:z};for(o=a.length;o--;){var l=t=a[o],u=l.name,c=l.namespaceURI;if(r=et(t.value),i=Je(u),s.attrName=i,s.attrValue=r,s.keepAttr=!0,s.forceKeepAttr=void 0,Ne("uponSanitizeAttribute",e,s),r=s.attrValue,!s.forceKeepAttr&&(Se(u,e),s.keepAttr))if(tt(/\/>/i,r))Se(u,e);else{V&&(r=Qe(r,D," "),r=Qe(r,C," "));var d=e.nodeName.toLowerCase();if(ke(d,i,r))try{c?e.setAttributeNS(c,u,r):e.setAttribute(u,r),$e(n.removed)}catch(e){}}}Ne("afterSanitizeAttributes",e,null)}},Ce=function e(t){var n=void 0,r=Ee(t);for(Ne("beforeSanitizeShadowDOM",t,null);n=r.nextNode();)Ne("uponSanitizeShadowNode",n,null),Fe(n)||(n.content instanceof o&&e(n.content),De(n));Ne("afterSanitizeShadowDOM",t,null)};return n.sanitize=function(e,i){var a=void 0,l=void 0,u=void 0,c=void 0,d=void 0;if(e||(e="\x3c!--\x3e"),"string"!=typeof e&&!Le(e)){if("function"!=typeof e.toString)throw nt("toString is not a function");if("string"!=typeof(e=e.toString()))throw nt("dirty is not a string, aborting")}if(!n.isSupported){if("object"===Et(t.toStaticHTML)||"function"==typeof t.toStaticHTML){if("string"==typeof e)return t.toStaticHTML(e);if(Le(e))return t.toStaticHTML(e.outerHTML)}return e}if(X||ye(i),n.removed=[],"string"==typeof e&&(re=!1),re);else if(e instanceof s)1===(l=(a=xe("\x3c!----\x3e")).ownerDocument.importNode(e,!0)).nodeType&&"BODY"===l.nodeName||"HTML"===l.nodeName?a=l:a.appendChild(l);else{if(!K&&!V&&!$&&-1===e.indexOf("<"))return A&&ee?A.createHTML(e):e;if(!(a=xe(e)))return K?null:S}a&&J&&Ae(a.firstChild);for(var f=Ee(re?e:a);u=f.nextNode();)3===u.nodeType&&u===c||Fe(u)||(u.content instanceof o&&Ce(u.content),De(u),c=u);if(c=null,re)return e;if(K){if(Q)for(d=L.call(a.ownerDocument);a.firstChild;)d.appendChild(a.firstChild);else d=a;return Z&&(d=N.call(r,d,!0)),d}var p=$?a.outerHTML:a.innerHTML;return V&&(p=Qe(p,D," "),p=Qe(p,C," ")),A&&ee?A.createHTML(p):p},n.setConfig=function(e){ye(e),X=!0},n.clearConfig=function(){he=null,X=!1},n.isValidAttribute=function(e,t,n){he||ye({});var r=Je(e),i=Je(t);return ke(r,i,n)},n.addHook=function(e,t){"function"==typeof t&&(k[e]=k[e]||[],Xe(k[e],t))},n.removeHook=function(e){k[e]&&$e(k[e])},n.removeHooks=function(e){k[e]&&(k[e]=[])},n.removeAllHooks=function(){k={}},n}();function Ct(e){if(!e)return!1;var t=e.tagName;if("TEXTAREA"===t||"INPUT"===t)return!0;for(;e.parentNode;){if(e.isContentEditable)return!0;e=e.parentNode}return!1}function Ot(e){Ct(e.target)||32!=e.keyCode&&38!=e.keyCode&&40!=e.keyCode&&33!=e.keyCode&&34!=e.keyCode||e.preventDefault()}function Mt(e){Ct(e.target)||(39!=e.keyCode&&40!=e.keyCode&&32!=e.keyCode&&34!=e.keyCode||kt(),37!=e.keyCode&&38!=e.keyCode&&33!=e.keyCode||Ft())}function It(e){null==e&&(e="");var t=document.querySelector(".story-furniture .caption");t&&(t.innerHTML=Dt.sanitize(e))}Dt.addHook("afterSanitizeAttributes",(function(e){"target"in e&&(e.setAttribute("target","_blank"),e.setAttribute("rel","noopener noreferrer"))}));var Rt,Ht,qt,Ut,zt,Pt,Bt,jt,Gt,Wt=!1;function Yt(e){if(Wt&&window.top!==window.self){var t=window;"srcdoc"===t.location.pathname&&(t=t.parent);var n,r=(n={},window._Flourish_template_id&&(n.template_id=window._Flourish_template_id),window.Flourish&&window.Flourish.app&&window.Flourish.app.loaded_template_id&&(n.template_id=window.Flourish.app.loaded_template_id),window._Flourish_visualisation_id&&(n.visualisation_id=window._Flourish_visualisation_id),window.Flourish&&window.Flourish.app&&window.Flourish.app.loaded_visualisation&&(n.visualisation_id=window.Flourish.app.loaded_visualisation.id),window.Flourish&&window.Flourish.app&&window.Flourish.app.story&&(n.story_id=window.Flourish.app.story.id,n.slide_count=window.Flourish.app.story.slides.length),window.Flourish&&window.Flourish.app&&window.Flourish.app.current_slide&&(n.slide_index=window.Flourish.app.current_slide.index+1),n),i={sender:"Flourish",method:"customerAnalytics"};for(var o in r)r.hasOwnProperty(o)&&(i[o]=r[o]);for(var o in e)e.hasOwnProperty(o)&&(i[o]=e[o]);t.parent.postMessage(JSON.stringify(i),"*")}}function Vt(e){if("function"!=typeof e)throw new Error("Analytics callback is not a function");window.Flourish._analytics_listeners.push(e)}function $t(){Wt=!0;[{event_name:"click",action_name:"click",use_capture:!0},{event_name:"keydown",action_name:"key_down",use_capture:!0},{event_name:"mouseenter",action_name:"mouse_enter",use_capture:!1},{event_name:"mouseleave",action_name:"mouse_leave",use_capture:!1}].forEach((function(e){document.body.addEventListener(e.event_name,(function(){Yt({action:e.action_name})}),e.use_capture)}))}function Xt(){if(null==Rt){var e=function(){var e=window.location;"about:srcdoc"==e.href&&(e=window.parent.location);var t={};return function(e,n,r){for(;r=n.exec(e);)t[decodeURIComponent(r[1])]=decodeURIComponent(r[2])}(e.search.substring(1).replace(/\+/g,"%20"),/([^&=]+)=?([^&]*)/g),t}();Rt="referrer"in e?/^https:\/\/medium.com\//.test(e.referrer):!("auto"in e)}return Rt}function Jt(e){var t=e||window.innerWidth;return t>999?650:t>599?575:400}function Kt(e){if(e&&window.top!==window.self){var t=window;"srcdoc"==t.location.pathname&&(t=t.parent);var n={sender:"Flourish",method:"scrolly"};if(e)for(var r in e)n[r]=e[r];t.parent.postMessage(JSON.stringify(n),"*")}}function Qt(e,t){if(window.top!==window.self){var n=window;if("srcdoc"==n.location.pathname&&(n=n.parent),Ht)return e=parseInt(e,10),void n.parent.postMessage({sentinel:"amp",type:"embed-size",height:e},"*");var r={sender:"Flourish",context:"iframe.resize",method:"resize",height:e,src:n.location.toString()};if(t)for(var i in t)r[i]=t[i];n.parent.postMessage(JSON.stringify(r),"*")}}function Zt(){return(-1!==navigator.userAgent.indexOf("Safari")||-1!==navigator.userAgent.indexOf("iPhone"))&&-1==navigator.userAgent.indexOf("Chrome")}function en(e){return"string"==typeof e||e instanceof String}function tn(e){return"warn"!==e.method?(console.warn("BUG: validateWarnMessage called for method"+e.method),!1):!(null!=e.message&&!en(e.message))&&!(null!=e.explanation&&!en(e.explanation))}function nn(e){return"resize"!==e.method?(console.warn("BUG: validateResizeMessage called for method"+e.method),!1):!!en(e.src)&&(!!en(e.context)&&!!("number"==typeof(t=e.height)?!isNaN(t)&&t>=0:en(t)&&/\d/.test(t)&&/^[0-9]*(\.[0-9]*)?(cm|mm|Q|in|pc|pt|px|em|ex|ch|rem|lh|vw|vh|vmin|vmax|%)?$/i.test(t)));var t}function rn(e){throw new Error("Validation for setSetting is not implemented yet; see issue #4328")}function on(e){return"scrolly"!==e.method?(console.warn("BUG: validateScrolly called for method"+e.method),!1):!!Array.isArray(e.slides)}function an(e){return"customerAnalytics"===e.method||(console.warn("BUG: validateCustomerAnalyticsMessage called for method"+e.method),!1)}function sn(e){return"request-upload"!==e.method?(console.warn("BUG: validateResizeMessage called for method"+e.method),!1):!!en(e.name)&&!(null!=e.accept&&!en(e.accept))}function ln(e,t){var n=function(e){for(var t={warn:tn,resize:nn,setSetting:rn,customerAnalytics:an,"request-upload":sn,scrolly:on},n={},r=0;r<e.length;r++){var i=e[r];if(!t[i])throw new Error("No validator found for method "+i);n[i]=t[i]}return n}(t);window.addEventListener("message",(function(t){if(null!=t.source&&(t.origin===document.location.origin||t.origin.match(/\/\/localhost:\d+$|\/\/(?:public|app)\.flourish.devlocal$|\/\/flourish-api\.com$|\.flourish\.(?:local(:\d+)?|net|rocks|studio)$|\.uri\.sh$|\/\/flourish-user-templates\.com$/))){var r;try{r=JSON.parse(t.data)}catch(e){return void console.warn("Unexpected non-JSON message: "+JSON.stringify(t.data))}if("Flourish"===r.sender)if(r.method)if(Object.prototype.hasOwnProperty.call(n,r.method))if(n[r.method](r)){for(var i=document.querySelectorAll("iframe"),o=0;o<i.length;o++)if(i[o].contentWindow==t.source||i[o].contentWindow==t.source.parent)return void e(r,i[o]);console.warn("could not find frame",r)}else console.warn("Validation failed for the message",r);else console.warn("No validator implemented for message",r);else console.warn("The 'method' property was missing from message",r)}})),Zt()&&(window.addEventListener("resize",un),un())}function un(){for(var e=document.querySelectorAll(".flourish-embed"),t=0;t<e.length;t++){var n=e[t];if(!n.getAttribute("data-width")){var r=n.querySelector("iframe");if(r){var i=window.getComputedStyle(n),o=n.offsetWidth-parseFloat(i.paddingLeft)-parseFloat(i.paddingRight);r.style.width=o+"px"}}}}function cn(e,t){var n=e.parentNode;if(n.classList.contains("fl-scrolly-wrapper"))console.warn("createScrolly is being called more than once per story. This should not happen.");else{n.classList.add("fl-scrolly-wrapper"),n.style.position="relative",n.style.paddingBottom="1px",n.style.transform="translate3d(0, 0, 0)",e.style.position="sticky";var r=n.getAttribute("data-height")||null;r||(r="80vh",e.style.height=r),e.style.top="calc(50vh - "+r+"/2)";var i=n.querySelector(".flourish-credit");i&&(i.style.position="sticky",i.style.top="calc(50vh + "+r+"/2)"),t.forEach((function(e,t){var r="string"==typeof e&&""!=e.trim(),i=document.createElement("div");i.setAttribute("data-slide",t),i.classList.add("fl-scrolly-caption"),i.style.position="relative",i.style.transform="translate3d(0,0,0)",i.style.textAlign="center",i.style.maxWidth="500px",i.style.height="auto",i.style.marginTop="0",i.style.marginBottom=r?"100vh":"50vh",i.style.marginLeft="auto",i.style.marginRight="auto";var o=document.createElement("div");o.innerHTML=e,o.style.visibility=r?"":"hidden",o.style.display="inline-block",o.style.paddingTop="1.25em",o.style.paddingRight="1.25em",o.style.paddingBottom="1.25em",o.style.paddingLeft="1.25em",o.style.background="rgba(255,255,255,0.9)",o.style.boxShadow="0px 0px 10px rgba(0,0,0,0.2)",o.style.borderRadius="10px",o.style.textAlign="center",o.style.maxWidth="100%",o.style.margin="0 20px",o.style.overflowX="hidden",i.appendChild(o),n.appendChild(i)})),function(e){for(var t=new IntersectionObserver((function(t){t.forEach((function(t){if(t.isIntersecting){var n=e.querySelector("iframe");n&&(n.src=n.src.replace(/#slide-.*/,"")+"#slide-"+t.target.getAttribute("data-slide"))}}))}),{rootMargin:"0px 0px -0% 0px"}),n=e.querySelectorAll(".fl-scrolly-caption"),r=0;r<n.length;r++)t.observe(n[r]);e.querySelectorAll(".fl-scrolly-caption img").forEach((function(e){e.style.maxWidth="100%"}))}(n)}}function dn(e,t,n,r,i){var o=document.createElement("iframe");if(o.setAttribute("scrolling","no"),o.setAttribute("frameborder","0"),o.setAttribute("title","Interactive or visual content"),o.setAttribute("sandbox","allow-same-origin allow-forms allow-scripts allow-downloads allow-popups allow-popups-to-escape-sandbox allow-top-navigation-by-user-activation"),t.appendChild(o),o.offsetParent||"fixed"===getComputedStyle(o).position)fn(e,t,o,n,r,i);else{var a={embed_url:e,container:t,iframe:o,width:n,height:r,play_on_load:i};if(window._flourish_poll_items?window._flourish_poll_items.push(a):window._flourish_poll_items=[a],window._flourish_poll_items.length>1)return o;var s=setInterval((function(){window._flourish_poll_items=window._flourish_poll_items.filter((function(e){return!e.iframe.offsetParent||(fn(e.embed_url,e.container,e.iframe,e.width,e.height,e.play_on_load),!1)})),window._flourish_poll_items.length||clearInterval(s)}),500)}return o}function fn(e,t,n,r,i,o){var a;return r&&"number"==typeof r?(a=r,r+="px"):r&&r.match(/^[ \t\r\n\f]*([+-]?\d+|\d*\.\d+(?:[eE][+-]?\d+)?)(?:\\?[Pp]|\\0{0,4}[57]0(?:\r\n|[ \t\r\n\f])?)(?:\\?[Xx]|\\0{0,4}[57]8(?:\r\n|[ \t\r\n\f])?)[ \t\r\n\f]*$/)&&(a=parseFloat(r)),i&&"number"==typeof i&&(i+="px"),r?n.style.width=r:Zt()?n.style.width=t.offsetWidth+"px":n.style.width="100%",!!i||(e.match(/\?/)?e+="&auto=1":e+="?auto=1",i=Jt(a||n.offsetWidth)+"px"),i&&("%"===i.charAt(i.length-1)&&(i=parseFloat(i)/100*t.parentNode.offsetHeight+"px"),n.style.height=i),n.setAttribute("src",e+(o?"#play-on-load":"")),n}function pn(){return Ht="#amp=1"==window.location.hash,{createEmbedIframe:dn,isFixedHeight:Xt,getHeightForBreakpoint:Jt,startEventListeners:ln,notifyParentWindow:Qt,initScrolly:Kt,createScrolly:cn,isSafari:Zt,initCustomerAnalytics:$t,addAnalyticsListener:Vt,sendCustomerAnalyticsMessage:Yt}}function hn(e){var t={};for(var n in e){for(var r=t,i=n.indexOf("."),o=0;i>=0;i=n.indexOf(".",o=i+1)){var a=n.substring(o,i);a in r||(r[a]={}),r=r[a]}r[n.substring(o)]=e[n]}return t}function mn(e){if(null==e)return e;var t,n={};for(var r in e)Array.isArray(e[r])?n[r]=e[r].slice():(t=e[r],Array.isArray(t)||"object"!=typeof t||null==t?n[r]=e[r]:n[r]=mn(e[r]));return n}var yn,vn=null;function gn(){return"MessageChannel"in window}var _n=null;function wn(){_n&&qt.removeEventListener("load",_n),_n=null}function bn(e){wn(),qt.addEventListener("load",e),_n=e}function An(e,t,n){return Bn(!1),Gt=e?e.visualisation?e.visualisation:e.current_slide.visualisation:null,vn=null,Gt&&Gt.template_id?(bn(function(e,t,n){var r=e.visualisation?e.visualisation.template_id:e.current_slide.visualisation.template_id,i=e.current_slide?e.current_slide.id:null;return function(){!Gt||Gt.template_id!=r||e.current_slide&&e.current_slide.id!==i||(wn(),kn((function(o,a){o?console.error("Failed to get default state"):!Gt||Gt.template_id!=r||e.current_slide&&e.current_slide.id!==i||Dn((function(o,s){if(o)console.error("Failed to call hasData");else if(Gt&&Gt.template_id==r&&(!e.current_slide||e.current_slide.id===i)){var l=!1;e.visualisation&&(l=e.data_bindings.requiredBindingsAreUnset()),s?Gt.refreshDataBindings((function(o){o?console.error("Failed to refresh data bindings"):!Gt||Gt.template_id!=r||e.current_slide&&e.current_slide.id!==i||Gt.prepareData((function(o,s){o?console.error("Failed to prepare data for template"):!Gt||Gt.template_id!=r||e.current_slide&&e.current_slide.id!==i||zn({data:s,state:t,draw:!l},(function(e,t){vn=a,n(e,t)}))}))})):zn({state:t,draw:!l},(function(e,t){vn=a,n(e,t)}))}}))})))}}(e,t,n)),qt.src="/template/"+Gt.template_id+"/embed/?auto=1&environment="+Ut+"&is_read_only="+(e.is_read_only?"1":"0"),qt):(wn(),qt.src="about:blank",qt)}function Sn(e){kn((function(t,n){t?console.error("Failed to get default state"):(vn=n,e())}))}function xn(e,t){var n=e.template_id;e.refreshDataBindings((function(r){r?console.error("Failed to fetch data bindings"):e.prepareData((function(e,r){if(Gt&&Gt.template_id==n)return e?(console.error("Failed to prepare data for template"),void t(e)):void t(void 0,r)}))}))}function En(e,t){xn(e,(function(e,n){if(e)return t(e);zn({data:n,update:!0},t)}))}function Tn(e,t){xn(e,(function(e,n){if(e)return t(e);zn({data:n,update:!1},t)}))}function Ln(e,t,n){xn(e,(function(e,r){if(e)return n(e);zn({data:r,state:t,overwrite_state:!0,update:!0},n)}))}function Nn(e,t,n){if(gn()){var r=new MessageChannel;r.port1.onmessage=function(e){var t=e.data;if("string"==typeof t){if(!n)return;return n(void 0,JSON.parse(t))}if("object"==typeof t){if("result"in t){if(!n)return;return n(void 0,t.result)}if("error"in t){if(!n)return;return n(t.error)}console.error("Unrecognised response to message",t)}else console.error("Unrecognised response to message",t)},qt.contentWindow.postMessage({sender:"Flourish",method:e,argument:t},"*",[r.port2])}}function Fn(e,t){Nn("setState",hn(e),t)}function kn(e,t){"function"!=typeof e?Nn("getState",e,t):Nn("getState",void 0,e)}function Dn(e){Nn("hasData",void 0,e)}function Cn(e,t){Nn("setData",e,t)}function On(e){Nn("getData",void 0,e)}function Mn(e){Nn("draw",void 0,e),Bn(!0)}function In(e){Bt&&Bt.clear(),Pn()&&Nn("update",void 0,e)}function Rn(e,t){Nn("snapshot",e,t)}function Hn(){return mn(vn)}function qn(e,t){Nn("setFixedHeight",e,t)}function Un(e){if(qt.parentNode.offsetWidth){if(void 0!==e)yn=null!=e;else if(yn)return;var t=e||Pt&&Pt.responsive_menu&&Pt.responsive_menu.getHeightSetting()||zt.getHeightForBreakpoint(qt.offsetWidth),n=typeof t;("number"===n||"string"===n&&!isNaN(t))&&(t+="px"),qt.style.height=t}}function zn(e,t){Pn()?delete e.draw:e.draw&&Bn(!0),e.state&&(e.state=hn(e.state)),Bt&&Bt.clear(),Nn("sync",e,(function(n,r){null!=n||"success"!==r?(e.draw&&Bn(!1),function n(r){r?t&&t(r):function(e,t){return e.data?(Cn(e.data,t),delete e.data,!1):e.state?(Fn(e.state,t),delete e.state,!1):e.draw?(Mn(t),delete e.draw,!1):!e.update||(In(t),delete e.update,!1)}(e,n)&&t&&t(void 0)}(n)):t&&t(void 0)}))}function Pn(){return jt}function Bn(e){jt=e}function jn(e,t,n,r,i){return qt=document.querySelector(e),Ut=t,Pt=n,Bt=r,i||(i={}),zt=pn(),qt.style.height=zt.getHeightForBreakpoint(qt.offsetWidth)+"px",zt.startEventListeners((function(e){"resize"==e.method?Un(e.height):"warn"==e.method?(Bt&&Bt.warn(e),console.warn("Warning from template:",e.message,e.explanation)):e.method in i&&i[e.method](e)}),["resize","warn","customerAnalytics","setSetting","request-upload"]),gn()||function(e){if(e){var t=document.createElement("div");t.className="unsupported-notice",t.innerHTML="<h3>Please update your browser</h3><p>This page only works with newer versions of your browser.</p>",e.appendChild(t)}}(qt.parentNode),{loadVisualisation:An,updateData:En,updateDataAndState:Ln,updateDataNotPreview:Tn,setState:Fn,getState:kn,getDefaultState:Hn,hasData:Dn,setData:Cn,getData:On,draw:Mn,update:In,snapshot:Rn,setFixedHeight:qn,resize:Un,sync:zn,getDrawCalled:Pn,setDrawCalled:Bn,setFrameLoadListener:bn,updateDefaultState:Sn}}var Gn,Wn,Yn;function Vn(e,t){for(var n in t)"object"!=typeof e[n]||null==e[n]||Array.isArray(e[n])||"object"!=typeof t[n]||null==t[n]||Array.isArray(t[n])?e[n]=t[n]:Vn(e[n],t[n])}function $n(e,t,n,r,i,o,a){var s=this;s.story=e,s.visualisations=t,s.data=n,s.frame=document.querySelector("#story iframe"),s.template_paths=r||{},s.enable_customer_analytics=a,s.auto_resize="scrolly"!=s.story.presentation_mode&&!Wn.isFixedHeight(),s.state="INIT",o?s.analytics=window.gtag=me:(s.analytics=ye(e.id,i),s.analytics("event","story",{play:e.id}));var l,u,c=window.location.hash,d=(c&&c.match(/^#play-on-load/)||s.story.is_timed&&s.story.plays_on_load)&&"scrolly"!=s.story.presentation_mode;if(e.slides.length>0){for(var f=0;f<e.slides.length;f++){var p=e.slides[f];p.visualisation_id&&(p.visualisation=t[p.visualisation_id])}c&&"#amp=1"!=c&&!d||(window.location.hash="#slide-0"),s.loadSlideFromHash()}function h(){s.previous()}function m(){s.next()}!function(e,t){Ft=e,kt=t}(h,m),window.addEventListener("keydown",Ot),window.addEventListener("keyup",Mt),s.auto_resize?(l=document.querySelector("iframe"),u=l.offsetHeight,Wn.startEventListeners((function(e){"resize"===e.method&&e.height!==u&&("number"!=typeof(u=e.height)&&(u=parseInt(u,10)),l.style.height=u+"px",Zn(l.offsetHeight+er()))}),["resize"])):s.updateHeight(),s.auto_resize||window.addEventListener("resize",(function(){s.updateHeight()}));var y=!0;ve=s,xe=d,_e=function(e){return window.location.hash="#slide-"+e,!0},Ce(),Oe(),Yn={update:Ce,play:Ne,pause:Fe,playPause:Le,updateTimecodes:Oe,jumpToSlide:Me};var v=document.querySelector(".first");v&&v.addEventListener("click",(function(){s.first()}));var g=document.querySelector(".previous");g&&g.addEventListener("click",h);var _=document.querySelectorAll(".play-pause");for(f=0;f<_.length;f++)_[f].addEventListener("click",(function(e){y&&(y=!1,Yn.jumpToSlide(s.current_slide.index)),Yn.playPause(),Wn.sendCustomerAnalyticsMessage({action:e.target.classList.contains("playing")?"play":"pause"})}));var w=document.querySelector(".next");w&&w.addEventListener("click",m);var b=document.querySelector(".last");b&&b.addEventListener("click",(function(){s.last()})),d&&function(){if(!Yn)return;var e=document.querySelector(".play-pause.large");e&&e.parentNode&&e.parentNode.removeChild(e);document.querySelector("iframe").addEventListener("load",(function(){Yn.play()}),!0)}()}$n.prototype.dispatchEvent=function(e,t){switch(e){case"slideChange":this.eventSlideChange(t);break;case"templateLoaded":this.eventTemplateLoaded(t);break;case"defaultStateFetched":this.eventDefaultStateFetched(t);break;case"syncDone":this.eventSyncDone(t);break;case"fadedOut":this.eventFadedOut(t);break;default:throw new Error("Unrecognised event: "+e)}},$n.prototype.eventSlideChange=function(e){var t=this,n=e.slide_index;n<0&&(n=0),n>=t.story.slides.length&&(n=t.story.slides.length-1);var r=t.current_slide,i=t.template_id;t.current_slide=t.story.slides[n];var o=t.current_slide.visualisation;switch(t.template_id=o&&o.template_id,t.state){case"LOADING_TEMPLATE":case"FETCHING_DEFAULT_STATE":if(t.template_id==i)break;case"INIT":case"EMPTY_SLIDE":if(!t.template_id){t.state="EMPTY_SLIDE",t.frame.src="about:blank",It(t.current_slide.caption_text);break}t.state="LOADING_TEMPLATE",t.loadTemplate();break;case"EMPTY_STORY":throw new Error("We cannot change slide in an empty story");case"FADING_OUT":break;case"SYNCING_SLIDE":case"READY":if(t.current_slide==r)return;if(t.template_id!=i){t.state="FADING_OUT",t.fadeFrameOut();break}t.state="SYNCING_SLIDE";var a=r.visualisation!==t.current_slide.visualisation;t.drawOrUpdateSlide("update",a,n);break;default:throw new Error("Unknown state: "+this.state)}t.updateControls(),t.updateSlideCount(),this.analytics("event","story",{load_slide:n}),Wn.sendCustomerAnalyticsMessage({action:"change_slide",slide_index:n+1})},$n.prototype.eventTemplateLoaded=function(e){var t=this,n=e.template_id;"LOADING_TEMPLATE"==t.state&&t.template_id==n&&(t.state="FETCHING_DEFAULT_STATE",t.fadeFrameIn(),Gn.updateDefaultState((function(){t.dispatchEvent("defaultStateFetched",{template_id:n})})))},$n.prototype.eventDefaultStateFetched=function(e){var t=this,n=e.template_id;"FETCHING_DEFAULT_STATE"==t.state&&t.template_id==n&&(t.state="SYNCING_SLIDE",t.drawOrUpdateSlide("draw",!0,t.current_slide.index))},$n.prototype.eventSyncDone=function(e){var t=this,n=e.slide_index;"SYNCING_SLIDE"==t.state&&t.current_slide.index==n&&(t.state="READY")},$n.prototype.eventFadedOut=function(){var e=this;if("FADING_OUT"==e.state){if(!e.template_id)return e.state="EMPTY_SLIDE",e.frame.src="about:blank",void It(e.current_slide.caption_text);e.state="LOADING_TEMPLATE",e.loadTemplate()}},$n.prototype.loadTemplate=function(){var e=this,t=e.template_id;Gn.setDrawCalled(!1);var n=e.template_paths[t]||"/template/"+t+"/embed";n+="?environment=story_player",e.auto_resize&&(n+="&auto=1"),e.enable_customer_analytics&&(n+="&enable_customer_analytics=1"),Gn.setFrameLoadListener((function(){e.dispatchEvent("templateLoaded",{template_id:t})})),e.frame.src=n},$n.prototype.drawOrUpdateSlide=function(e,t,n){var r=this;It(r.current_slide.caption_text),r.populateStateAndData(e,t,(function(){r.dispatchEvent("syncDone",{slide_index:n})})),r.updateHeight()},$n.prototype.noSlidesBefore=function(){return!this.current_slide||this.current_slide.index<1},$n.prototype.noSlidesAfter=function(){return!this.current_slide||this.current_slide.index==this.story.slides.length-1},$n.prototype.previous=function(){if(!this.noSlidesBefore()){this.analytics("event","story",{previous:this.current_slide.index});var e=this.current_slide.index-1;window.location.hash="#slide-"+e}},$n.prototype.next=function(){if(!this.noSlidesAfter()){this.analytics("event","story",{next:this.current_slide.index});var e=this.current_slide.index+1;window.location.hash="#slide-"+e}},$n.prototype.first=function(){this.noSlidesBefore()||(this.analytics("event","story",{first:this.current_slide.index}),window.location.hash="#slide-0")},$n.prototype.last=function(){this.noSlidesAfter()||(this.analytics("event","story",{last:this.current_slide.index}),window.location.hash="#slide-"+(this.story.slides.length-1))},$n.prototype.populateStateAndData=function(e,t,n){var r=this.current_slide,i=r.visualisation,o={};Vn(o,Gn.getDefaultState()),Vn(o,hn(i.settingsForCurrentTemplate())),Vn(o,r.state);var a={state:o,overwrite_state:!0};t&&(a.data=this.data[i.id]),a[e]=!0,Gn.sync(a,n)};var Xn=null;function Jn(){Xn&&(cancelAnimationFrame(Xn),Xn=null)}$n.prototype.fadeFrameOut=function(){var e=this;Jn();var t=null,n=function(r){null==t&&(t=r);var i=r-t,o=Math.min(1,Math.max(0,i/250));e.frame.style.opacity=1-o,1==o?(Xn=null,e.dispatchEvent("fadedOut",{})):Xn=requestAnimationFrame(n)};Xn=requestAnimationFrame(n)},$n.prototype.fadeFrameIn=function(){var e=this;Jn();var t=null,n=function(r){null==t&&(t=r);var i=r-t,o=Math.min(1,Math.max(0,i/250));e.frame.style.opacity=o,Xn=1==o?null:requestAnimationFrame(n)};Xn=requestAnimationFrame(n)};var Kn=null;function Qn(){Kn||(Kn={furniture:document.querySelector(".story-furniture"),progress:document.querySelector(".progress span, .progress-indicator .progress"),previous:document.querySelector(".previous"),next:document.querySelector(".next"),first:document.querySelector(".first"),last:document.querySelector(".last"),count_current:document.querySelector(".count .current, .count-current"),count_total:document.querySelector(".count .total, .count-total")})}function Zn(e){e&&Wn.notifyParentWindow(e,{player:!0})}function er(){var e=0,t=document.querySelector(".story-furniture");return t&&"absolute"!==getComputedStyle(t).position&&(e=t.offsetHeight),e}return $n.prototype.updateControls=function(){var e,t=this,n=t.current_slide;e=t.story.slides.length<2?0:n.index/(t.story.slides.length-1),Qn(),Kn.progress&&(Kn.progress.style.width=100*e+"%"),document.querySelector("nav")?(t.noSlidesBefore()?(Kn.previous.setAttribute("disabled",""),Kn.first.setAttribute("disabled","")):(Kn.previous.removeAttribute("disabled"),Kn.first.removeAttribute("disabled")),t.noSlidesAfter()?(Kn.next.setAttribute("disabled",""),Kn.last.setAttribute("disabled","")):(Kn.next.removeAttribute("disabled"),Kn.last.removeAttribute("disabled"))):(t.noSlidesBefore()?(Kn.previous&&Kn.previous.classList.add("disabled"),Kn.first&&Kn.first.classList.add("disabled")):(Kn.previous&&Kn.previous.classList.remove("disabled"),Kn.first&&Kn.first.classList.remove("disabled")),t.noSlidesAfter()?(Kn.next&&Kn.next.classList.add("disabled"),Kn.last&&Kn.last.classList.add("disabled")):(Kn.next&&Kn.next.classList.remove("disabled"),Kn.last&&Kn.last.classList.remove("disabled"))),Kn.furniture&&(null!=n&&n.caption_text?Kn.furniture.classList.add("has-caption"):Kn.furniture.classList.remove("has-caption"))},$n.prototype.updateSlideCount=function(){Qn(),Kn.count_current&&(Kn.count_current.innerHTML=this.current_slide.index+1),Kn.count_total&&(Kn.count_total.innerHTML=this.story.slides.length)},$n.prototype.loadSlideFromHash=function(){var e=window.location.hash;if(e&&e.match(/^#slide-/)){var t=parseInt(e.substr("#slide-".length));this.dispatchEvent("slideChange",{slide_index:t})}},$n.prototype.updateHeight=function(){var e=document.querySelector("iframe");if(this.auto_resize){Zn(e.offsetHeight+er())}else{var t=document.body.offsetHeight-er();t!==e.offsetHeight&&(e.style.height=t+"px")}},e.Slide=function(e,n,r){this.story=e,t(this,n,void 0,r)},e.Story=function(e,n,r,i,o){t(this,e,n,r),this.slides=i,this.slides_by_id={};for(var a=0;a<i.length;a++){var s=i[a];s.story=this,this.slides_by_id[s.id]=s}this.status=o},e.Visualisation=r,e.initStoryPlayer=function(e,t,n,r,i,o,a){Gn=jn("#story iframe","story_player",void 0,void 0,{customerAnalytics:function(e){"mouse_enter"!==e.action&&"mouse_leave"!==e.action&&Wn.sendCustomerAnalyticsMessage(e)}}),Wn=pn(),a&&Wn.initCustomerAnalytics(),window.Flourish=window.Flourish||{};var s=window.Flourish.app=new $n(t,n,r,i,e,o,a);if(window.addEventListener("hashchange",(function(){s.loadSlideFromHash()})),"scrolly"==t.presentation_mode){var l=t.slides.map((function(e){var t=e.caption_text?e.caption_text.replace(/<p>/g,'<p style="margin: 0">'):"";return Dt.sanitize(t)}));Wn.initScrolly({slides:l})}},Object.defineProperty(e,"__esModule",{value:!0}),e}({});
