import { withRouter } from 'react-router-dom';
import { connect } from 'react-redux';
import Component from './country-climate-vulnerability-component';
import actions from './country-climate-vulnerability-actions';

export { initialState } from './country-climate-vulnerability-reducers';
export { default as reducers } from './country-climate-vulnerability-reducers';
export { default as actions } from './country-climate-vulnerability-actions';

const mapStateToProps = state => {
  const { countryClimateVulnerability, adaptations } = state;
  const isObj =
    Object.keys(adaptations.data).length === 0 &&
    adaptations.data.constructor === Object;
  const sections = isObj ? [] : adaptations.data;
  const sectionTemplates =
    sections.length > 0
      ? [
        {
          sectionType: 'gauge',
          data: sections.filter(section => section.slug === 'poverty_14')
        },
        {
          sectionType: 'line',
          data: sections.filter(section => section.slug === 'climate_risks')
        },
        {
          sectionType: 'list',
          data: sections.filter(section =>
            section.slug.startsWith('hazard_')
          ),
          title: 'Key hazards'
        },
        {
          sectionType: 'gauge',
          data: sections.filter(section => section.slug === 'readiness')
        },
        {
          sectionType: 'gauge',
          data: sections.filter(section => section.slug === 'vulnerability')
        },
        {
          sectionType: 'link',
          data: sections.filter(section => section.slug === 'wb_urls')
        }
      ]
      : [];

  return {
    toogleInfo: countryClimateVulnerability.toogleInfo,
    infoOpen: countryClimateVulnerability.infoOpen,
    sectionTemplates
  };
};

export default withRouter(connect(mapStateToProps, actions)(Component));
